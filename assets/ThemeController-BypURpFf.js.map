{"version":3,"file":"ThemeController-BypURpFf.js","sources":["../../src/components/common/ThemeController.tsx"],"sourcesContent":["import { memo, useCallback, useEffect, useMemo, useState } from 'react';\nimport { useTheme } from '../../hooks/useTheme';\nimport { FaSun, FaMoon, FaDesktop, FaMobileAlt, FaTabletAlt } from 'react-icons/fa';\n\nconst useMediaQuery = (query: string): boolean => {\n  const getMatches = (mediaQuery: string): boolean => {\n    if (typeof window !== 'undefined') {\n      return window.matchMedia(mediaQuery).matches;\n    }\n    return false;\n  };\n\n  const [matches, setMatches] = useState(getMatches(query));\n\n  useEffect(() => {\n    if (typeof window === 'undefined') {\n      return;\n    }\n\n    const mediaQuery = window.matchMedia(query);\n\n    const handleChange = (e: MediaQueryListEvent) => {\n      setMatches(e.matches);\n    };\n\n    mediaQuery.addEventListener('change', handleChange);\n\n    return () => {\n      mediaQuery.removeEventListener('change', handleChange);\n    };\n  }, [query]);\n\n  return matches;\n};\n\ntype Theme = 'light' | 'dark' | 'system';\ntype DeviceType = 'desktop' | 'mobile' | 'tablet';\n\ninterface ThemeControllerProps {\n  showLabel?: boolean;\n  className?: string;\n  labelPosition?: 'left' | 'right';\n  size?: 'sm' | 'md' | 'lg';\n  showTooltip?: boolean;\n  animated?: boolean;\n}\n\nconst THEME_ORDER: Theme[] = ['light', 'dark', 'system'];\n\nconst DEVICE_BREAKPOINTS = {\n  mobile: 768,\n  tablet: 1024,\n} as const;\n\nconst ICON_SIZES = {\n  sm: 'w-4 h-4',\n  md: 'w-5 h-5',\n  lg: 'w-6 h-6',\n} as const;\n\nconst BUTTON_SIZES = {\n  sm: 'p-1.5',\n  md: 'p-2',\n  lg: 'p-2.5',\n} as const;\n\nconst ANIMATION_CLASSES = {\n  light: 'animate-rotate-sun',\n  dark: 'animate-rotate-moon',\n  system: 'animate-rotate-system',\n} as const;\n\nconst THEME_LABELS = {\n  light: 'Light theme',\n  dark: 'Dark theme',\n  system: 'System theme',\n} as const;\n\nconst DEVICE_ICONS = {\n  mobile: FaMobileAlt,\n  tablet: FaTabletAlt,\n  desktop: FaDesktop,\n} as const;\n\nconst ThemeController = memo<ThemeControllerProps>(({\n  showLabel = false,\n  className = '',\n  labelPosition = 'right',\n  size = 'md',\n  showTooltip = true,\n  animated = true,\n}) => {\n  const { theme, setTheme } = useTheme();\n  const prefersReducedMotion = useMediaQuery('(prefers-reduced-motion: reduce)');\n  const prefersDark = useMediaQuery('(prefers-color-scheme: dark)');\n  const isMobile = useMediaQuery(`(max-width: ${DEVICE_BREAKPOINTS.mobile}px)`);\n  const isTablet = useMediaQuery(`(max-width: ${DEVICE_BREAKPOINTS.tablet}px)`);\n\n  const deviceType = useMemo((): DeviceType => {\n    if (isMobile) return 'mobile';\n    if (isTablet) return 'tablet';\n    return 'desktop';\n  }, [isMobile, isTablet]);\n\n  const iconSize = useMemo(() => ICON_SIZES[size], [size]);\n  const buttonSize = useMemo(() => BUTTON_SIZES[size], [size]);\n  \n  const shouldAnimate = useMemo(() => \n    animated && !prefersReducedMotion,\n    [animated, prefersReducedMotion]\n  );\n\n  const getNextTheme = useCallback((currentTheme: Theme): Theme => {\n    const currentIndex = THEME_ORDER.indexOf(currentTheme);\n    const nextIndex = (currentIndex + 1) % THEME_ORDER.length;\n    return THEME_ORDER[nextIndex];\n  }, []);\n\n  const handleThemeChange = useCallback(() => {\n    setTheme(getNextTheme(theme as Theme));\n  }, [theme, setTheme, getNextTheme]);\n\n  useEffect(() => {\n    if (theme === 'system') {\n      document.documentElement.setAttribute(\n        'data-theme',\n        prefersDark ? 'dark' : 'light'\n      );\n    }\n  }, [theme, prefersDark]);\n\n  const renderIcon = useCallback(() => {\n    const animationClass = shouldAnimate ? ANIMATION_CLASSES[theme as Theme] || '' : '';\n    const baseClasses = `${iconSize} transition-transform duration-200`;\n    const combinedClasses = `${baseClasses} ${animationClass}`;\n\n    switch (theme) {\n      case 'light':\n        return <FaSun className={`text-content ${combinedClasses}`} aria-hidden=\"true\" />;\n      case 'dark':\n        return <FaMoon className={`text-content ${combinedClasses}`} aria-hidden=\"true\" />;\n      case 'system': {\n        const DeviceIcon = DEVICE_ICONS[deviceType];\n        return <DeviceIcon className={`text-info ${combinedClasses}`} aria-hidden=\"true\" />;\n      }\n      default:\n        return null;\n    }\n  }, [theme, deviceType, shouldAnimate, iconSize]);\n\n  const buttonContent = useMemo(() => (\n    <>\n      {renderIcon()}\n      {showLabel && (\n        <span className={`text-sm font-medium ${labelPosition === 'left' ? 'ml-2' : 'mr-2'}`}>\n          Theme\n        </span>\n      )}\n    </>\n  ), [showLabel, labelPosition, renderIcon]);\n\n  const handleKeyDown = useCallback((event: React.KeyboardEvent) => {\n    if (event.key === 'Enter' || event.key === ' ') {\n      event.preventDefault();\n      handleThemeChange();\n    }\n  }, [handleThemeChange]);\n\n  return (\n    <button\n      className={`\n        inline-flex items-center justify-center rounded-full\n        hover:bg-base-200 focus:outline-none focus:ring-2\n        focus:ring-offset-2 focus:ring-info\n        ${buttonSize}\n        ${className}\n      `}\n      onClick={handleThemeChange}\n      onKeyDown={handleKeyDown}\n      aria-label={`Switch theme to ${getNextTheme(theme as Theme)} mode`}\n      title={showTooltip ? THEME_LABELS[theme as Theme] : undefined}\n      data-theme-controller\n      role=\"switch\"\n      aria-checked={theme === 'dark'}\n      data-testid={`theme-switch-${theme}`}\n    >\n      <div className=\"flex items-center justify-center relative\">\n        {buttonContent}\n      </div>\n    </button>\n  );\n});\n\nThemeController.displayName = 'ThemeController';\n\nexport default ThemeController;\nexport type { Theme, DeviceType, ThemeControllerProps };\n"],"names":["useMediaQuery","query","matches","setMatches","useState","mediaQuery","window","matchMedia","useEffect","handleChange","e","addEventListener","removeEventListener","THEME_ORDER","DEVICE_BREAKPOINTS","ICON_SIZES","sm","md","lg","BUTTON_SIZES","ANIMATION_CLASSES","light","dark","system","THEME_LABELS","DEVICE_ICONS","mobile","FaMobileAlt","tablet","FaTabletAlt","desktop","FaDesktop","ThemeController","memo","showLabel","className","labelPosition","size","showTooltip","animated","theme","setTheme","useTheme","prefersReducedMotion","prefersDark","isMobile","isTablet","deviceType","useMemo","iconSize","buttonSize","shouldAnimate","getNextTheme","useCallback","currentTheme","nextIndex","indexOf","length","handleThemeChange","document","documentElement","setAttribute","renderIcon","combinedClasses","FaSun","FaMoon","DeviceIcon","buttonContent","jsxs","Fragment","children","jsx","handleKeyDown","event","key","preventDefault","jsxRuntimeExports","onClick","onKeyDown","title","role","displayName"],"mappings":"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"}